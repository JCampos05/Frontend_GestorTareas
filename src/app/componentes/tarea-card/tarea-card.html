<div class="tarea-card" [attr.data-tarea-id]="tarea.idTarea" [attr.data-estado]="tarea.estado" (click)="onTareaClick()">
  <div class="tarea-content">
    <!-- Checkbox -->
    <input
      type="checkbox"
      [checked]="tarea.estado === 'C'"
      (change)="onCheckboxChange($event)"
      class="tarea-checkbox">

    <!-- Contenido principal -->
    <div class="tarea-main">
      <!-- Título -->
      <div class="tarea-info">
        <strong [class.tarea-completada]="tarea.estado === 'C'" [title]="tarea.nombre">
          <span class="tarea-nombre-texto">{{ tarea.nombre }}</span>
          <i *ngIf="tarea.prioridad === 'A'" class="fas fa-exclamation-triangle prioridad-alta"></i>
        </strong>
      </div>

      <!-- Metadata: Lista, Fecha, etc. -->
      <div class="tarea-bottom">
        <div class="tarea-metadata">
          <span *ngIf="tarea.nombreLista" class="tarea-lista-badge" [title]="tarea.nombreLista">
            <span *ngIf="esEmoji(tarea.iconoLista)" class="lista-emoji">{{ tarea.iconoLista }}</span>
            <span *ngIf="!esEmoji(tarea.iconoLista)" class="lista-icon-wrapper" [style.background-color]="tarea.colorLista || '#6554c0'">
              <i [class]="obtenerClaseIcono(tarea.iconoLista)"></i>
            </span>
            <span class="tarea-nombre-lista">{{ tarea.nombreLista }}</span>
            <i *ngIf="tarea.importante" class="fas fa-star estrella-importante"></i>
          </span>

          <span *ngIf="tarea.fechaVencimiento" class="tarea-fecha">
            <i class="far fa-calendar"></i>
            {{ formatearFecha(tarea.fechaVencimiento) }}
          </span>
        </div>
      </div>
    </div>

    <!-- Acciones (aparecen al hacer hover) -->
    <div class="tarea-acciones-hover">
      <button
        *ngIf="mostrarBotonIniciar"
        (click)="cambiarEstado($event, 'N')"
        class="btn-accion"
        title="Iniciar">
        <i class="fas fa-play"></i>
      </button>

      <button
        *ngIf="mostrarBotonesProceso"
        (click)="cambiarEstado($event, 'P')"
        class="btn-accion"
        title="Pausar">
        <i class="fas fa-pause"></i>
      </button>

      <button
        *ngIf="mostrarBotonesProceso"
        (click)="cambiarEstado($event, 'C')"
        class="btn-accion"
        title="Completar">
        <i class="fas fa-check"></i>
      </button>

      <button
        *ngIf="mostrarBotonReabrir"
        (click)="cambiarEstado($event, 'P')"
        class="btn-accion"
        title="Reabrir">
        <i class="fas fa-redo"></i>
      </button>

      <button
        (click)="alternarMiDia($event)"
        class="btn-accion"
        [class.mi-dia-activo]="tarea.miDia"
        [title]="tarea.miDia ? 'Quitar de Mi Día' : 'Agregar a Mi Día'">
        <i class="fas fa-sun"></i>
      </button>

      <button
        (click)="eliminarTarea($event)"
        class="btn-accion btn-eliminar"
        title="Eliminar tarea">
        <i class="fas fa-trash"></i>
      </button>
    </div>
  </div>
</div>
